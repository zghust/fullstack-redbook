"use strict";(self.webpackChunkredbook01=self.webpackChunkredbook01||[]).push([[306],{306:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var i,s=n(2791),o=n(3267),l=n(9150),a=n(8778),r=n(3835),c=n(1065),d=n(5057),h=n(1274),m=n(1773),x=n(1777),p=n(168);const g=n(4210).ZP.div(i||(i=(0,p.Z)(["\n  .add {\n    box-sizing: border-box;\n    width: 100%;\n    height: 100vh;\n    padding: 20px;\n    .top {\n      box-sizing: border-box;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      font-size: 20px;\n      padding-bottom: 30px;\n      .back {\n        padding: 10px 20px;\n      }\n    }\n  }\n"])));var u=n(184);function f(e){let{navigate:t}=e;const[n,i]=(0,s.useState)([]),[p,f]=(0,s.useState)(),w=(0,s.useRef)();const C={onRemove:e=>{const t=n.indexOf(e),s=n.slice();s.splice(t,1),i(s)},beforeUpload:e=>{if(!e.type.startsWith("image/"))return o.FN.show("\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6\uff01"),!1;!function(e,t){const n=new FileReader;n.readAsDataURL(e),n.onload=n=>{const i=new Image;i.src=n.target.result,i.onload=()=>{const n=document.createElement("canvas"),s=n.getContext("2d");let o=i.width,l=i.height;o>l?o>800&&(l*=800/o,o=800):l>600&&(o*=600/l,l=600),n.width=o,n.height=l,s.drawImage(i,0,0,o,l),n.toBlob((n=>{const i=new File([n],e.name,{type:e.type,lastModified:Date.now()});t(i)}),e.type)}}}(e,(e=>{((e,t)=>{const n=new FileReader;n.addEventListener("load",(()=>t(n.result))),n.readAsDataURL(e)})(e,(e=>{f(e)})),i([...n,e])}))},fileList:n};return(0,u.jsx)(g,{children:(0,u.jsxs)("div",{className:"add",children:[(0,u.jsxs)("div",{className:"top",children:[(0,u.jsx)("div",{onClick:()=>t(-1),className:"back",children:(0,u.jsx)(a.Z,{fontSize:20})}),(0,u.jsx)(r.Z,{fontSize:20})]}),(0,u.jsx)("div",{children:(0,u.jsxs)(d.Z,{onFinish:async e=>{let{title:i,content:s}=e;try{const e=new FormData;if(e.append("title",i),e.append("content",s),n.forEach((t=>{e.append("cover",t)})),0!==n.length){const n=await(0,l.Z)({method:"post",url:"/moment/my",data:e});o.FN.show(n.data.message),t("/home")}else o.FN.show("\u5c01\u9762\u4e0d\u80fd\u4e3a\u7a7a~")}catch(a){console.error("\u4e0a\u4f20\u5931\u8d25:",a)}},children:[(0,u.jsx)(d.Z.Item,{name:"cover",rules:[{required:!0,message:"\u6587\u7ae0\u5c01\u9762\u4e0d\u80fd\u4e3a\u7a7a\uff01"}],children:(0,u.jsx)("div",{children:(0,u.jsx)(h.Z,{listType:"picture-card",showUploadList:!1,...C,children:p?(0,u.jsx)("img",{className:"head",src:p,style:{width:100,height:100},alt:"cover"}):(0,u.jsx)("div",{children:(0,u.jsx)(c.Z,{fontSize:24,color:"grey"})})})})}),(0,u.jsx)(d.Z.Item,{name:"title",rules:[{required:!0,message:"\u6587\u7ae0\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a\uff01"}],children:(0,u.jsx)(o.II,{placeholder:"\u8bf7\u8f93\u5165\u6587\u7ae0\u6807\u9898",style:{width:400}})}),(0,u.jsx)(o.iz,{}),(0,u.jsx)(d.Z.Item,{name:"content",rules:[{required:!0,message:"\u6587\u7ae0\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a\uff01"}],children:(0,u.jsx)(o.Kx,{placeholder:"\u8bf7\u8f93\u5165\u5185\u5bb9",rows:15,showCount:!0,maxLength:3e3})}),(0,u.jsx)(d.Z.Item,{children:(0,u.jsx)(m.Z,{size:"large",children:(0,u.jsx)(x.ZP,{type:"primary",htmlType:"submit",ref:w,children:"\u53d1\u5e03\u6587\u7ae0"})})})]})})]})})}const w=(0,s.memo)(f)},3835:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(2791);const s=function(e){return i.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 49 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),i.createElement("g",{id:"InformationCircleOutline-InformationCircleOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.createElement("g",{transform:"translate(1.000000, 0.000000)",id:"InformationCircleOutline-\u7f16\u7ec4"},i.createElement("rect",{id:"InformationCircleOutline-\u77e9\u5f62",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),i.createElement("path",{d:"M24,2 C36.1502645,2 46,11.8497355 46,24 C46,36.1502645 36.1502645,46 24,46 C11.8497355,46 2,36.1502645 2,24 C2,11.8497355 11.8497355,2 24,2 Z M24,5 C13.5065898,5 5,13.5065898 5,24 C5,34.4934102 13.5065898,43 24,43 C34.4934102,43 43,34.4934102 43,24 C43,13.5065898 34.4934102,5 24,5 Z M25.6,20 C25.8209139,20 26,20.1790861 26,20.4 L26,34.6 C26,34.8209139 25.8209139,35 25.6,35 L23.4,35 C23.1790861,35 23,34.8209139 23,34.6 L23,23 L21.4,23 C21.1790861,23 21,22.8209139 21,22.6 L21,20.4 C21,20.1790861 21.1790861,20 21.4,20 L25.6,20 Z M25.6,14 C25.8209139,14 26,14.1790861 26,14.4 L26,16.6 C26,16.8209139 25.8209139,17 25.6,17 L23.4,17 C23.1790861,17 23,16.8209139 23,16.6 L23,14.4 C23,14.1790861 23.1790861,14 23.4,14 L25.6,14 Z",id:"InformationCircleOutline-\u5f62\u72b6\u7ed3\u5408",fill:"currentColor",fillRule:"nonzero"}))))}}}]);
//# sourceMappingURL=306.2c27f4fc.chunk.js.map